cryptsetup --cipher aes-xts-plain64 --key-size 512 --hash sha512 --iter-time 5000 --use-random luksFormat /dev/sda2

staR242&7787$&&&

cryptsetup luksOpen /dev/sda2 crypto

mkfs.fat -F 32 /dev/sda1


mkfs.btrfs -L rootfs /dev/mapper/crypto


mount /dev/mapper/crypto /mnt

mkdir /mnt/boot

mount /dev/sda1 /mnt/boot

export XBPS_ARCH=x86_64-musl


xbps-install -Sy --repository=https://alpha.de.repo.voidlinux.org/current/musl --rootdir /mnt base-system cryptsetup grub-x86_64-efi nano



mount -t proc /proc /mnt/proc
mount --rbind /dev /mnt/dev
mount --rbind /sys /mnt/sys


ANTES COPIAR EL RESOLV

cp -L /etc/resolv.conf /mnt/etc




chroot /mnt /bin/bash

chsh -s /bin/bash

passwd


# create a zero length file
truncate -s 0 /swapfile

# disable cow
chattr +C /swapfile

# disable compression
btrfs property set /swapfile compression none

# allocate the size
fallocate -l 24g /swapfile  SOLO 8g

# lock down permissions
chmod 600 /swapfile

# make it swappable
mkswap /swapfile


useradd --create-home --groups wheel,users,audio,video,storage,input --shell /bin/bash mjpier

passwd mjpier


visudo

# fire the visudo command
# and uncomment the following line
# to allow sudo access to
# users in the wheel group

%wheel ALL=(ALL) ALL

:q!
:wq

x
l




# add the hostname to /etc/hostname
# replace gibson with your hostname
echo void-OS > /etc/hostname


# tweak the language for your locale in /etc/locale.conf
echo LANG=es_PE.UTF-8 > /etc/locale.conf



# tweak the following lines in /etc/rc.conf
cat <<EOF > /etc/rc.conf

# /etc/rc.conf - system configuration for void
HARDWARECLOCK="UTC"
TIMEZONE="America/Lima"
KEYMAP="la-latin1"

EOF





cat <<EOF > /etc/hosts 

# /etc/hosts: static lookup table for host names
#<ip-address>	<hostname.domain.org>	<hostname>

127.0.0.1 void-OS.lan void-OS localhost.localdomain localhost

::1 void-OS.lan void-OS localhost.localdomain localhost ip6-localhost

# End of file

EOF





# add the following lines to your /etc/fstab
nano /etc/fstab

/dev/sda1 /boot vfat rw,noatime,discard 0 2

/swapfile none swap defaults 0 0


touch /etc/dracut.conf.d/override.conf

nano /etc/dracut.conf.d/override.conf

hostonly=yes





# edit the following lines in /etc/default/grub
nano /etc/default/grub


GRUB_TIMEOUT=0
GRUB_CMDLINE_LINUX_DEFAULT="loglevel=4 rd.auto=1 rd.luks.allow-discards"



# install grub
grub-install --target=x86_64-efi --efi-directory=/boot

# generate grub config
grub-mkconfig -o /boot/grub/grub.cfg




Last step is to generate the initramfs image using dracut.

# replace 5.8 with the correct version
# you can find it in the output
# of the grub command above
xbps-reconfigure -fa


# exit the chroot
exit

# unmount recursively from /mnt
umount -R /mnt

reboot

sudo xbps-install -S rofi make xsetroot imlib2-devel 

xbps-install libXft-devel libX11-devel harfbuzz-devel libXext-devel libXrender-devel libXinerama-devel
sudo xbps-install -S htop git xorg-minimal xorg-fonts xf86-input-libinput

sudo xbps-install -S xterm neofetch picom feh xrdb






























